@startuml
title Leader Recruiter Performance Dashboard - Sequence Diagram

autonumber 1

actor "Leader Recruiter" as Leader
participant "RecruitmentDashboardController" as API
participant "RecruitmentDashboardAppService" as Service
participant "RecruiterRepository" as RecruiterRepo
participant "ActivityLogRepository" as ActivityRepo
database "Database" as DB

Leader -> API : GET /company-dashboard
activate API
note over Leader, API
DashboardFilterDto:
- StartDate
- EndDate
- SortBy
- IncludeInactive
end note

API -> Service : GetCompanyDashboardAsync(filter)
activate Service

autonumber 1.1
Service -> RecruiterRepo : GetCurrentRecruiterProfileAsync()
activate RecruiterRepo

autonumber 1.1.1
RecruiterRepo -> DB : ExecuteQuery()
activate DB
return Return result

autonumber 1.1.2
return Return currentRecruiterProfile

autonumber 1.2
Service -> Service : Validate IsLead()

alt Not a Leader
    autonumber 1.2.1
    return Return error message
    autonumber 1.2.2
    return Return 403 Forbidden
else Is Leader
    autonumber 1.3
    Service -> RecruiterRepo : Get all staff in company
    activate RecruiterRepo
    
    autonumber 1.3.1
    RecruiterRepo -> DB : ExecuteQuery()
    activate DB
    return Return result
    
    autonumber 1.3.2
    return Return staffList
    
    autonumber 1.4
    Service -> ActivityRepo : Get activity logs (filtered)
    activate ActivityRepo
    
    autonumber 1.4.1
    ActivityRepo -> DB : ExecuteQuery()
    activate DB
    return Return result
    
    autonumber 1.4.2
    return Return activityLogs
    
    autonumber 1.5
    Service -> Service : Calculate staff performance
    note right of Service
    For each staff:
    - Count jobs posted/closed
    - Count candidates approved
    - Count interviews completed
    - Calculate approval rate
    - Calculate metrics
    end note
    
    autonumber 1.6
    Service -> Service : Calculate company statistics
    note right of Service
    Aggregate:
    - Total jobs posted
    - Total candidates approved
    - Overall approval rate
    - Average activities per staff
    end note
    
    autonumber 1.7
    Service -> Service : Calculate top performers
    note right of Service
    Identify top performers:
    - Most jobs posted
    - Most candidates approved
    - Highest approval rate
    end note
    
    autonumber 1.8
    Service -> Service : Sort staff by criteria
    
    autonumber 1.9
    Service -> Service : Build CompanyDashboardDto
    
    autonumber 1.10
    return Return dashboard data
    
    autonumber 1.11
    return Return 200 OK + JSON
end

@enduml





