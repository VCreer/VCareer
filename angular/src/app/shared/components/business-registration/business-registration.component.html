<div class="business-registration">
  <!-- Section Header -->
  <div class="section-header">
    <div class="section-header-left">
      <h2 class="section-title">Thông tin Giấy đăng ký doanh nghiệp</h2>
      <p class="section-instruction">
        Vui lòng lựa chọn phương thức đăng tải, xem hướng dẫn đăng tải 
        <a href="#" class="instruction-link" target="_blank">Tại đây</a>.
      </p>
    </div>
    <div class="section-header-right" *ngIf="legalStatus || documentUrl">
      <div class="status-and-link" *ngIf="legalStatus">
        <span class="status-badge" [ngClass]="getStatusClass()">
          {{ getStatusLabel() }}
        </span>
      </div>
      <button
        *ngIf="documentUrl && !isEditing"
        type="button"
        class="edit-button"
        (click)="onEditClick()"
      >
        Chỉnh sửa
      </button>
    </div>
  </div>

  <!-- Document Type Selection -->
  <div class="document-type-selection">
    <label class="radio-option">
      <input 
        type="radio" 
        name="documentType" 
        value="business-cert"
        [(ngModel)]="documentType"
        (change)="onDocumentTypeChange('business-cert')"
        checked>
      <span class="radio-label">Giấy đăng ký doanh nghiệp hoặc Giấy tờ tương đương khác</span>
    </label>
    <!--<label class="radio-option">
      <input 
        type="radio" 
        name="documentType" 
        value="authorization"
        [(ngModel)]="documentType"
        (change)="onDocumentTypeChange('authorization')">
      <span class="radio-label">Giấy ủy quyền và Giấy tờ định danh</span>
    </label> -->
  </div>

  <!-- Content Card -->
  <div class="content-card" *ngIf="documentType === 'business-cert'">
    <!-- View mode: đã có file và không ở chế độ chỉnh sửa -->
    <div class="content-wrapper view-mode" *ngIf="documentUrl && !isEditing">
      <div class="upload-section">
        <label class="upload-label">
          Giấy tờ<span class="required-star">*</span>
        </label>
        <div class="uploaded-file-info">
          <i class="fa fa-file-pdf file-icon"></i>
          <a
            class="file-link"
            [href]="documentUrl"
            target="_blank"
            rel="noopener noreferrer"
          >
            Giấy đăng ký doanh nghiệp
          </a>
        </div>
      </div>
      <div class="illustration-section">
        <h3 class="illustration-title">Minh họa</h3>
        <div class="illustration-image">
          <img [src]="getIllustrationImage()" alt="Minh họa giấy tờ" />
        </div>
      </div>
    </div>

    <!-- Edit mode / lần đầu nộp: hiện khu vực upload -->
    <div class="content-wrapper" *ngIf="!documentUrl || isEditing">
      <!-- Left Side: File Upload -->
      <div class="upload-section">
        <label class="upload-label">Giấy tờ<span class="required-star">*</span></label>
        
        <div 
          class="upload-area"
          [class.drag-over]="isDragOver"
          (dragover)="onDragOver($event)"
          (dragleave)="onDragLeave($event)"
          (drop)="onDrop($event)">
          <div class="upload-content" *ngIf="!selectedFile">
            <p class="upload-instruction">Chọn hoặc kéo file vào đây</p>
            <p class="upload-specs">Dung lượng tối đa 5MB, định dạng: jpeg, jpg, png, pdf</p>
            <app-button 
              [type]="'primary'"
              [size]="'medium'"
              (click)="onSelectFileClick($event, fileInput)"
              class="upload-btn">
              <i class="fa fa-upload"></i>
              Chọn file
            </app-button>
          </div>
          <div class="file-preview" *ngIf="selectedFile">
            <i class="fa fa-file-pdf file-icon"></i>
            <p class="file-name">{{ selectedFile.name }}</p>
            <button class="remove-file-btn" (click)="selectedFile = null; fileError = ''">
              <i class="fa fa-times"></i>
            </button>
          </div>
          <input 
            #fileInput
            type="file" 
            accept=".jpeg,.jpg,.png,.pdf"
            (change)="onFileSelect($event)"
            style="display: none;">
        </div>

        <span class="error-message" *ngIf="fileError">{{ fileError }}</span>

        <!-- Warning Messages -->
        <div class="warning-messages">
          <div class="warning-item">
            <i class="fa fa-exclamation-triangle warning-icon"></i>
            <p class="warning-text">
              Các văn bản đăng tải cần đầy đủ các mặt và không có dấu hiệu chỉnh sửa/ che/ cắt thông tin. Vui lòng đăng tải Giấy đăng ký doanh nghiệp có thông tin trùng khớp với dữ liệu của doanh nghiệp theo Trang thông tin điện tử của Cục Thuế
            </p>
          </div>
        </div>
      </div>

      <!-- Right Side: Illustration -->
      <div class="illustration-section">
        <h3 class="illustration-title">Minh họa</h3>
        <div class="illustration-image">
          <img [src]="getIllustrationImage()" alt="Minh họa giấy tờ" />
        </div>
      </div>
    </div>
  </div>


  <!-- Save Button -->
  <div class="form-actions" *ngIf="!documentUrl || isEditing">
    <div class="actions-wrapper">
      <app-button 
        [type]="'primary'"
        [size]="'medium'"
        [disabled]="isSaving || !selectedFile"
        [loading]="isSaving"
        (click)="onSave()"
        class="save-btn">
        Lưu
      </app-button>
      <button
        *ngIf="documentUrl && isEditing"
        type="button"
        class="cancel-btn"
        (click)="onCancelClick()">
        Hủy
      </button>
    </div>
  </div>
</div>

