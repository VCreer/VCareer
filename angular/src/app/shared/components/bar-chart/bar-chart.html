<div class="bar-chart-container" [style.height.px]="height">
  <div class="chart-wrapper" *ngIf="chartData.length > 0">
    <!-- Y-Axis -->
    <div class="y-axis">
      <!-- Y-Axis Main Line -->
      <div class="y-axis-main-line"></div>
      <div
        *ngFor="let label of yAxisLabels; let i = index"
        class="y-axis-label"
        [style.top.%]="getYAxisPosition(label)">
        <span class="y-axis-value">{{ label | number:'1.0-0' }}</span>
        <div class="y-axis-tick"></div>
      </div>
    </div>

    <!-- Chart Area -->
    <div class="chart-area">
      <!-- Y-Axis Extension Line (inside chart area) -->
      <div class="y-axis-extension-line"></div>
      
      <!-- X-Axis Line -->
      <div class="x-axis-line"></div>

      <!-- Grid Lines -->
      <div class="grid-lines">
        <div
          *ngFor="let label of yAxisLabels"
          class="grid-line"
          [style.top.%]="getYAxisPosition(label)">
        </div>
      </div>

      <!-- Bars -->
      <div class="chart-bars">
        <div
          *ngFor="let item of chartData; let i = index"
          class="bar-item"
          [style.--bar-color]="getBarColor(item, i)">
          <div class="bar-wrapper">
            <div 
              class="bar" 
              [style.height.%]="getBarHeight(item.value)"
              (mouseenter)="onBarHover($event, item)"
              (mouseleave)="onBarLeave()"
              (mousemove)="onBarHover($event, item)">
              <span class="bar-value" *ngIf="showValues && item.value > 0">
                {{ item.value | number:'1.0-0' }}
              </span>
            </div>
          </div>
          <div class="bar-label">{{ item.label }}</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Legend -->
  <div class="chart-legend" *ngIf="chartData.length > 0">
    <div class="legend-items">
      <div
        *ngFor="let item of chartData; let i = index"
        class="legend-item">
        <div class="legend-color-box">
          <div class="legend-color" [style.background-color]="getBarColor(item, i)"></div>
        </div>
        <span class="legend-label" [style.color]="getBarColor(item, i)">{{ item.label }}</span>
      </div>
    </div>
  </div>

  <div class="chart-empty" *ngIf="chartData.length === 0">
    <i class="fas fa-chart-bar"></i>
    <p>Chưa có dữ liệu</p>
  </div>

  <!-- Tooltip -->
  <div 
    class="chart-tooltip" 
    *ngIf="showTooltip"
    [style.left.px]="tooltipX"
    [style.top.px]="tooltipY">
    {{ tooltipText }}
  </div>
</div>

