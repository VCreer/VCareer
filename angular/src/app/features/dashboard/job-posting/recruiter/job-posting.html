<div class="job-posting-page" [class.sidebar-expanded]="sidebarExpanded">
  <!-- Toast Notification -->
  <app-toast-notification
    [show]="showToast"
    [message]="toastMessage"
    [type]="toastType"
    (close)="onToastClose()">
  </app-toast-notification>

  <!-- Breadcrumb Box -->
  <div class="breadcrumb-box" [class.sidebar-expanded]="sidebarExpanded">
    <div class="breadcrumb-container">
      <div class="page-header">
        <h1 class="page-title">Đăng tin tuyển dụng</h1>
        <span class="campaign-badge" *ngIf="campaignName">
          Chiến dịch: {{ campaignName }}
        </span>
      </div>
      <div class="action-buttons">
        <app-button 
          type="secondary" 
          size="small" 
          (click)="openPreviewModal()">
          Xem trước
        </app-button>
        <app-button 
          type="secondary" 
          size="small" 
          (click)="onSaveJob()">
          Lưu việc làm
        </app-button>
        <app-button 
          type="primary" 
          size="small" 
          (click)="onPostJob()">
          Đăng công việc
        </app-button>
      </div>
    </div>
  </div>

  <!-- Content Wrapper -->
  <div class="content-wrapper">
    <!-- Form -->
    <div class="form-wrapper">
      <h2 class="form-main-title">Thông tin công việc</h2>
      
      <!-- General Information Section -->
      <div class="form-section">
        <h3 class="section-title">Thông tin chung</h3>
        
        <!-- Position Level -->
        <app-select-field
          label="Cấp bậc"
          placeholder="Chọn cấp bậc"
          [required]="true"
          [options]="positionLevelOptions"
          [error]="getFieldError('positionLevel')"
          [(ngModel)]="jobForm.positionLevel"
          (ngModelChange)="onFieldChange('positionLevel')"
          name="positionLevel">
        </app-select-field>

        <!-- Education -->
        <app-select-field
          label="Học vấn"
          placeholder="Chọn học vấn"
          [required]="true"
          [options]="educationOptions"
          [error]="getFieldError('education')"
          [(ngModel)]="jobForm.education"
          (ngModelChange)="onFieldChange('education')"
          name="education">
        </app-select-field>

        <!-- Quantity -->
        <app-input-field
          label="Số lượng tuyển"
          type="number"
          placeholder="Nhập số lượng tuyển"
          [required]="true"
          [error]="getFieldError('quantity')"
          [(ngModel)]="jobForm.quantity"
          (ngModelChange)="onFieldChange('quantity')"
          name="quantity">
        </app-input-field>

        <!-- Employment Type -->
        <app-select-field
          label="Hình thức làm việc"
          placeholder="Chọn hình thức làm việc"
          [required]="true"
          [options]="employmentTypeOptions"
          [error]="getFieldError('employmentType')"
          [(ngModel)]="jobForm.employmentType"
          (ngModelChange)="onFieldChange('employmentType')"
          name="employmentType">
        </app-select-field>
      </div>

      <!-- Job Title Section -->
      <div class="form-section">
        <h3 class="section-title">Tên Công việc</h3>
        
        <!-- Job Title -->
        <app-input-field
          label="Tên công việc"
          type="text"
          placeholder="Nhập tên công việc"
          [required]="true"
          [error]="getFieldError('jobTitle')"
          [(ngModel)]="jobForm.jobTitle"
          (ngModelChange)="onFieldChange('jobTitle')"
          name="jobTitle">
        </app-input-field>

        <!-- Location - Province, District, Ward -->
        <div class="location-row">
          <app-select-field
            label="Tỉnh/Thành phố"
            placeholder="Chọn tỉnh/thành phố"
            [required]="true"
            [options]="provinceOptions"
            [error]="getFieldError('province')"
            [(ngModel)]="jobForm.province"
            (ngModelChange)="onFieldChange('province')"
            name="province"
            class="location-field">
          </app-select-field>
          
          <app-select-field
            label="Quận/Huyện"
            placeholder="Chọn quận/huyện"
            [required]="true"
            [options]="districtOptions"
            [error]="getFieldError('district')"
            [(ngModel)]="jobForm.district"
            (ngModelChange)="onFieldChange('district')"
            name="district"
            class="location-field"
            [disabled]="!jobForm.province">
          </app-select-field>
          
          <app-select-field
            label="Xã/Phường"
            placeholder="Chọn xã/phường"
            [required]="true"
            [options]="wardOptions"
            [error]="getFieldError('ward')"
            [(ngModel)]="jobForm.ward"
            (ngModelChange)="onFieldChange('ward')"
            name="ward"
            class="location-field"
            [disabled]="!jobForm.district">
          </app-select-field>
        </div>

        <!-- Salary -->
        <app-input-field
          label="Mức lương"
          type="number"
          placeholder="Nhập mức lương (VNĐ)"
          [required]="true"
          [error]="getFieldError('salary')"
          [(ngModel)]="jobForm.salary"
          (ngModelChange)="onFieldChange('salary')"
          name="salary"
          min="0">
        </app-input-field>

        <!-- Experience -->
        <app-select-field
          label="Kinh nghiệm"
          placeholder="Chọn kinh nghiệm"
          [required]="true"
          [options]="experienceOptions"
          [error]="getFieldError('experience')"
          [(ngModel)]="jobForm.experience"
          (ngModelChange)="onFieldChange('experience')"
          name="experience">
        </app-select-field>

        <!-- Application Deadline -->
        <app-input-field
          label="Hạn nộp hồ sơ"
          type="date"
          placeholder="Chọn hạn nộp hồ sơ"
          [required]="true"
          [error]="getFieldError('applicationDeadline')"
          [(ngModel)]="jobForm.applicationDeadline"
          (ngModelChange)="onFieldChange('applicationDeadline')"
          name="applicationDeadline">
        </app-input-field>
      </div>

      <!-- Job Description Section -->
      <div class="form-section">
        <h3 class="section-title">Mô tả công việc</h3>
        
        <!-- Job Description (Rich Text Editor) -->
        <app-rich-text-editor
          label="Mô tả công việc"
          placeholder="Nhập mô tả chi tiết về công việc..."
          [required]="true"
          [(ngModel)]="jobForm.description"
          (ngModelChange)="onFieldChange('description')"
          name="description">
        </app-rich-text-editor>
        <div class="error-message" *ngIf="getFieldError('description')">
          {{ getFieldError('description') }}
        </div>
      </div>

      <!-- Requirements Section -->
      <div class="form-section">
        <h3 class="section-title">Yêu cầu ứng viên</h3>
        
        <!-- Requirements (Rich Text Editor) -->
        <app-rich-text-editor
          label="Yêu cầu ứng viên"
          placeholder="Nhập các yêu cầu đối với ứng viên..."
          [required]="true"
          [(ngModel)]="jobForm.requirements"
          (ngModelChange)="onFieldChange('requirements')"
          name="requirements">
        </app-rich-text-editor>
        <div class="error-message" *ngIf="getFieldError('requirements')">
          {{ getFieldError('requirements') }}
        </div>
      </div>

      <!-- Benefits Section -->
      <div class="form-section">
        <h3 class="section-title">Quyền lợi</h3>
        
        <!-- Benefits (Rich Text Editor) -->
        <app-rich-text-editor
          label="Quyền lợi"
          placeholder="Nhập các quyền lợi mà ứng viên sẽ nhận được..."
          [required]="true"
          [(ngModel)]="jobForm.benefits"
          (ngModelChange)="onFieldChange('benefits')"
          name="benefits">
        </app-rich-text-editor>
        <div class="error-message" *ngIf="getFieldError('benefits')">
          {{ getFieldError('benefits') }}
        </div>
      </div>

      <!-- Work Location Section -->
      <div class="form-section">
        <h3 class="section-title">Địa điểm làm việc</h3>
        
        <!-- Work Location -->
        <app-input-field
          label="Địa điểm làm việc"
          type="text"
          placeholder="Nhập địa điểm làm việc cụ thể"
          [required]="true"
          [error]="getFieldError('workLocation')"
          [(ngModel)]="jobForm.workLocation"
          (ngModelChange)="onFieldChange('workLocation')"
          name="workLocation">
        </app-input-field>
      </div>

    </div>

  <!-- Preview Modal -->
  <app-generic-modal
    [show]="showPreviewModal"
    title="Xem trước"
    maxWidth="1400px"
    bodyBackground="#f8fafc"
    (close)="closePreviewModal()">
    <app-job-preview [jobData]="jobForm"></app-job-preview>
  </app-generic-modal>
</div>