<div class="candidate-profile">
  <div class="profile-layout">
    <!-- Left Panel - Personal Information Settings -->
    <div class="left-panel">
      <div class="settings-container">
        <h1 class="settings-title">Thông tin cá nhân</h1>
        <p class="required-note">(*) Các thông tin bắt buộc</p>
        
        <form class="profile-form" (ngSubmit)="onSaveProfile(profileData)">
          <div class="form-group">
            <label class="form-label required">Họ và tên</label>
            <input 
              type="text" 
              class="form-input" 
              [class.error]="errors.fullName"
              [class.valid]="profileData.fullName && !errors.fullName"
              [(ngModel)]="profileData.fullName"
              name="fullName"
              required>
            <span class="error-message" *ngIf="errors.fullName">{{ errors.fullName }}</span>
          </div>
          
          <div class="form-group">
            <label class="form-label required">Số điện thoại</label>
            <input 
              type="tel" 
              class="form-input" 
              [class.error]="errors.phone"
              [class.valid]="profileData.phone && !errors.phone"
              [(ngModel)]="profileData.phone"
              name="phone"
              pattern="[0-9]{10,11}"
              title="Số điện thoại phải có 10-11 chữ số"
              required>
            <span class="error-message" *ngIf="errors.phone">{{ errors.phone }}</span>
          </div>
          
          <div class="form-group">
            <label class="form-label">Email</label>
            <input 
              type="email" 
              class="form-input" 
              [(ngModel)]="profileData.email"
              name="email"
              disabled>
          </div>
          
          <div class="form-group">
            <label class="form-label required">Địa chỉ</label>
            <input 
              type="text" 
              class="form-input" 
              [class.error]="errors.address"
              [class.valid]="profileData.address && !errors.address"
              [(ngModel)]="profileData.address"
              name="address"
              required>
            <span class="error-message" *ngIf="errors.address">{{ errors.address }}</span>
          </div>
          
          <div class="form-group">
            <label class="form-label required">Ngày sinh</label>
            <input 
              type="date" 
              class="form-input" 
              [class.error]="errors.dateOfBirth"
              [class.valid]="profileData.dateOfBirth && !errors.dateOfBirth"
              [(ngModel)]="profileData.dateOfBirth"
              name="dateOfBirth"
              required>
            <span class="error-message" *ngIf="errors.dateOfBirth">{{ errors.dateOfBirth }}</span>
          </div>
          
          <div class="form-group">
            <label class="form-label required">Giới tính</label>
            <select 
              class="form-input" 
              [class.error]="errors.gender"
              [class.valid]="profileData.gender && !errors.gender"
              [(ngModel)]="profileData.gender"
              name="gender"
              required>
              <option value="">Chọn giới tính</option>
              <option value="male">Nam</option>
              <option value="female">Nữ</option>
              <option value="other">Khác</option>
            </select>
            <span class="error-message" *ngIf="errors.gender">{{ errors.gender }}</span>
          </div>
          
          <button type="submit" class="save-button" [disabled]="isSaving">
            <span *ngIf="!isSaving">Lưu</span>
            <span *ngIf="isSaving">Đang lưu...</span>
          </button>
        </form>
      </div>
    </div>

    <!-- Right Sidebar - User Status and Settings -->
    <div class="right-sidebar">
      <!-- User Profile Card -->
      <div class="user-card">
        <div class="profile-picture-container" (click)="openAvatarModal()">
          <img src="assets/images/default-avatar.png" alt="Profile" class="profile-picture">
          <div class="camera-icon">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path>
              <circle cx="12" cy="13" r="4"></circle>
            </svg>
          </div>
        </div>
        
        <div class="user-info">
          <h3 class="welcome-text">Chào bạn trở lại, {{ profileData.fullName }}</h3>
          <div class="verified-status">
            <span class="verified-text">Tài khoản đã xác thực</span>
          </div>
          <button class="upgrade-button">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M7 17L17 7M17 7H7M17 7V17"></path>
            </svg>
            Nâng cấp tài khoản
          </button>
        </div>
      </div>


      <!-- Contact Information Settings -->
      <div class="contact-section">
        <h4 class="contact-title">Khi có cơ hội việc làm phù hợp, NTD sẽ liên hệ và trao đổi với bạn qua:</h4>
        <div class="contact-options">
          <div class="contact-option">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
              <polyline points="22,6 12,13 2,6"></polyline>
            </svg>
            <span>Email và Số điện thoại của bạn</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Avatar Edit Modal -->
  <div class="avatar-modal" *ngIf="showAvatarModal" (click)="closeAvatarModal($event)">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>CHỈNH SỬA ẢNH ĐẠI DIỆN</h2>
      </div>
      
      <div class="modal-body">
        <!-- Left Column - Image Preview -->
        <div class="image-preview-section">
          <h3>Ảnh hiển thị trên CV</h3>
          <div class="preview-container">
            <img [src]="previewImage || profileData.avatarUrl || 'assets/images/default-avatar.png'" alt="Preview" class="preview-image">
          </div>
        </div>

        <!-- Right Column - Action Buttons -->
        <div class="action-section">
          <div class="action-buttons">
            <button class="change-btn" (click)="triggerFileInput()">Đổi ảnh</button>
            <button class="delete-btn" (click)="deleteImage()">Xóa ảnh</button>
            <button class="done-btn" (click)="saveAvatar()">Xong</button>
            <button class="cancel-btn" (click)="cancelAvatarEdit()">Đóng lại (Không lưu)</button>
          </div>
          <input type="file" id="avatar-input" class="file-input" accept="image/*" (change)="onImageSelect($event)" style="display: none;">
        </div>
      </div>
    </div>
  </div>
</div>