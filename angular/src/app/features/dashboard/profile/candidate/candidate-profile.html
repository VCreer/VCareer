<div class="candidate-profile" *ngIf="!isLoading">
  <div class="profile-layout">
    <!-- Left Panel - Personal Information Settings -->
    <div class="left-panel">
      <div class="settings-container">
        <h1 class="settings-title">Thông tin cá nhân</h1>
        <p class="required-note">(*) Các thông tin bắt buộc</p>
        
        <form class="profile-form" (ngSubmit)="onSaveProfile(profileData)">
          <div class="form-group">
            <label class="form-label required">Họ và tên</label>
            <input 
              type="text" 
              class="form-input" 
              [class.error]="errors.fullName"
              [class.valid]="profileData.fullName && !errors.fullName"
              [(ngModel)]="profileData.fullName"
              name="fullName"
              required>
            <span class="error-message" *ngIf="errors.fullName">{{ errors.fullName }}</span>
          </div>
          
          <div class="form-group">
            <label class="form-label required">Số điện thoại</label>
            <input 
              type="tel" 
              class="form-input" 
              [class.error]="errors.phone"
              [class.valid]="profileData.phone && !errors.phone"
              [(ngModel)]="profileData.phone"
              name="phone"
              pattern="[0-9]{10,11}"
              title="Số điện thoại phải có 10-11 chữ số"
              required>
            <span class="error-message" *ngIf="errors.phone">{{ errors.phone }}</span>
          </div>
          
          <div class="form-group">
            <label class="form-label">Email</label>
            <input 
              type="email" 
              class="form-input" 
              [(ngModel)]="profileData.email"
              name="email"
              disabled>
          </div>
          
          <div class="form-group">
            <label class="form-label required">Địa chỉ</label>
            <input 
              type="text" 
              class="form-input" 
              [class.error]="errors.address"
              [class.valid]="profileData.address && !errors.address"
              [(ngModel)]="profileData.address"
              name="address"
              required>
            <span class="error-message" *ngIf="errors.address">{{ errors.address }}</span>
          </div>
          
          <div class="form-group">
            <label class="form-label required">Ngày sinh</label>
            <input 
              type="date" 
              class="form-input" 
              [class.error]="errors.dateOfBirth"
              [class.valid]="profileData.dateOfBirth && !errors.dateOfBirth"
              [(ngModel)]="profileData.dateOfBirth"
              name="dateOfBirth"
              required>
            <span class="error-message" *ngIf="errors.dateOfBirth">{{ errors.dateOfBirth }}</span>
          </div>
          
          <div class="form-group">
            <label class="form-label required">Giới tính</label>
            <select 
              class="form-input" 
              [class.error]="errors.gender"
              [class.valid]="profileData.gender && !errors.gender"
              [(ngModel)]="profileData.gender"
              name="gender"
              required>
              <option value="">Chọn giới tính</option>
              <option value="male">Nam</option>
              <option value="female">Nữ</option>
              <option value="other">Khác</option>
            </select>
            <span class="error-message" *ngIf="errors.gender">{{ errors.gender }}</span>
          </div>
          
          <button type="submit" class="save-button" [disabled]="isSaving">
            <span *ngIf="!isSaving">Lưu</span>
            <span *ngIf="isSaving">Đang lưu...</span>
          </button>
        </form>
      </div>
    </div>

    <!-- Right Sidebar - User Status and Settings -->
    <div class="right-sidebar">
      <!-- Profile Sidebar Section -->
      <div class="profile-sidebar-section">
        <!-- Profile Card -->
        <div class="profile-card">
          <div class="profile-layout">
            <!-- Left Column - Profile Icon -->
            <div class="profile-left-column">
              <div class="profile-icon" (click)="openAvatarModal()">
                <i class="fa fa-user-circle"></i>
              </div>
            </div>
            
            <!-- Right Column - Profile Info -->
            <div class="profile-right-column">
              <div class="profile-info">
                <span class="profile-label">Profile</span>
                <h3>Chào bạn trở lại, {{ profileData.fullName }}</h3>
              </div>
              
              <div class="account-status">
                <span class="verified-badge">Tài khoản đã xác thực</span>
              </div>
              
              <button class="upgrade-btn">
                <i class="fa fa-arrow-up"></i>
                Nâng cấp tài khoản
              </button>
            </div>
          </div>

          <!-- Toggle Settings Section -->
          <div class="toggle-settings-section">
            <!-- Toggle 1: Job Search Status -->
            <div class="toggle-setting-item">
              <div class="toggle-wrapper">
                <label class="toggle-label">
                  <input 
                    type="checkbox" 
                    class="toggle-input" 
                    [ngModel]="jobSearchEnabled"
                    (change)="onJobSearchToggle($event)"
                    [checked]="jobSearchEnabled">
                  <span class="toggle-slider" [class.active]="jobSearchEnabled"></span>
                </label>
                <div class="toggle-content">
                  <span class="toggle-text" [class.inactive]="!jobSearchEnabled">
                    {{ jobSearchEnabled ? 'Đang bật tìm việc' : 'Đang Tắt tìm việc' }}
                  </span>
                  <p class="toggle-description">
                    Bật tìm việc giúp hồ sơ của bạn nổi bật hơn và được chú ý nhiều hơn trong danh sách tìm kiếm của NTD.
                  </p>
                </div>
              </div>
            </div>

            <!-- Toggle 2: Allow Recruiter Search -->
            <div class="toggle-setting-item">
              <div class="toggle-wrapper">
                <label class="toggle-label">
                  <input 
                    type="checkbox" 
                    class="toggle-input" 
                    [ngModel]="allowRecruiterSearch"
                    (change)="onAllowRecruiterSearchToggle($event)"
                    [checked]="allowRecruiterSearch">
                  <span class="toggle-slider" [class.active]="allowRecruiterSearch"></span>
                </label>
                <div class="toggle-content">
                  <span class="toggle-text">
                    Cho phép NTD tìm kiếm hồ sơ
                  </span>
                  <div class="toggle-description-container">
                    <p class="toggle-description">
                      Khi có cơ hội việc làm phù hợp, NTD sẽ liên hệ và trao đổi với bạn qua
                    </p>
                    <div class="contact-method">
                      <i class="fa fa-envelope contact-icon"></i>
                      <span>Email & Số điện thoại</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Profile Picture Edit Modal -->
  <app-profile-picture-edit-modal
    *ngIf="showProfilePictureModal"
    (close)="closeProfilePictureModal()"
    (changePicture)="onProfilePictureChange()"
    (deletePicture)="onProfilePictureDelete()">
  </app-profile-picture-edit-modal>
</div>

<!-- Loading indicator -->
<div class="loading-container" *ngIf="isLoading">
  <div class="loading-spinner"></div>
  <p>Đang tải dữ liệu...</p>
</div>

<!-- Enable Job Search Modal -->
<app-enable-job-search-modal
  [show]="showEnableJobSearchModal"
  (close)="onCloseEnableJobSearchModal()"
  (enableJobSearch)="onEnableJobSearch($event)">
</app-enable-job-search-modal>