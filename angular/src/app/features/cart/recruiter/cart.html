<div class="cart-page" [class.sidebar-expanded]="sidebarExpanded">
  <!-- Toast Notification -->
  <app-toast-notification
    [show]="showToast"
    [message]="toastMessage"
    [type]="toastType"
    (close)="onToastClose()">
  </app-toast-notification>

  <!-- Breadcrumb Box -->
  <div class="breadcrumb-box" [class.sidebar-expanded]="sidebarExpanded">
    <div class="breadcrumb-container">
      <h1 class="page-title">Giỏ hàng của tôi ({{ cartItems.length }})</h1>
    </div>
  </div>

  <div class="container" *ngIf="cartItems.length > 0">
    <!-- Important Note -->
    <div class="important-note">
      <div class="note-header">
        <i class="fa fa-info-circle note-icon"></i>
        <h3 class="note-title">Lưu ý quan trọng</h3>
      </div>
      <p class="note-text">
        Nhằm tránh rủi ro mạo danh và lừa đảo, VCareer khuyến nghị Quý khách hàng không chuyển khoản vào bất cứ tài khoản cá nhân nào và chỉ thực hiện thanh toán vào các tài khoản chính thức của chúng tôi
      </p>
    </div>

    <div class="cart-content">
      <!-- Left Section: Cart Items -->
      <div class="cart-items-section">
        <table class="cart-table">
          <thead>
            <tr>
              <th class="checkbox-col">
                <input 
                  type="checkbox" 
                  [checked]="isAllSelected()"
                  (change)="toggleSelectAll($event)"
                  class="select-all-checkbox">
              </th>
              <th class="service-name-col">TÊN DỊCH VỤ</th>
              <th class="price-col">ĐƠN GIÁ (VND)</th>
              <th class="quantity-col">SỐ LƯỢNG</th>
              <th class="amount-col">SỐ TIỀN (VND)</th>
              <th class="action-col">THAO TÁC</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of cartItems" class="cart-item-row">
              <td class="checkbox-col">
                <input 
                  type="checkbox" 
                  [checked]="isItemSelected(item.id)"
                  (change)="toggleSelectItem(item.id, $event)"
                  class="item-checkbox">
              </td>
              <td class="service-name-col">
                <div class="service-info">
                  <h3 class="service-name">{{ item.title }}</h3>
                  <p class="service-description">
                    Trải nghiệm đăng tin tuyển dụng hiệu quả với vị trí nổi bật trong Việc làm tốt nhất kết hợp cùng các dịch vụ cao cấp, giá dùng thử hấp dẫn.
                  </p>
                </div>
              </td>
              <td class="price-col">
                <span class="unit-price">{{ item.price }}</span>
              </td>
              <td class="quantity-col">
                <div class="quantity-control">
                  <button 
                    type="button" 
                    class="quantity-btn minus-btn"
                    disabled>
                    -
                  </button>
                  <input 
                    type="number" 
                    class="quantity-input"
                    [value]="item.quantity"
                    min="1"
                    disabled>
                  <button 
                    type="button" 
                    class="quantity-btn plus-btn"
                    disabled>
                    +
                  </button>
                </div>
              </td>
              <td class="amount-col">
                <span class="item-amount">{{ formatCurrency(getItemAmount(item)) }}</span>
              </td>
              <td class="action-col">
                <button 
                  type="button" 
                  class="remove-btn"
                  (click)="removeItem(item.id)"
                  aria-label="Xóa sản phẩm">
                  <i class="fa fa-trash"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Right Section: Order Summary -->
      <div class="order-summary-section">
        <div class="order-summary-card">
          <h2 class="summary-title">THÔNG TIN ĐƠN HÀNG</h2>

          <!-- Order Details -->
          <div class="order-details">
            <div class="detail-row">
              <span class="detail-label">Tổng giá trị đơn hàng</span>
              <span class="detail-value">{{ formatCurrency(getSubtotal()) }} VND</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Tổng tiền chưa bao gồm VAT</span>
              <span class="detail-value">{{ formatCurrency(getSubtotal()) }} VND</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">VAT (8%)</span>
              <span class="detail-value">{{ formatCurrency(getVAT()) }} VND</span>
            </div>
            <div class="discount-row">
              <button 
                type="button" 
                class="discount-btn"
                (click)="onSelectDiscountCode()">
                Chọn mã ưu đãi
              </button>
            </div>
          </div>

          <!-- Total Payment -->
          <div class="total-payment">
            <div class="total-row">
              <span class="total-label">Tổng số tiền thanh toán</span>
              <span class="total-amount">
                <span class="total-value">{{ formatCurrency(getTotal()) }}</span>
                <span class="total-currency"> VND</span>
              </span>
            </div>
            <p class="vat-note">(Đã bao gồm VAT)</p>
          </div>

          <!-- Terms and Conditions -->
          <div class="terms-section">
            <label class="terms-checkbox">
              <input 
                type="checkbox" 
                [(ngModel)]="agreeToTerms">
              <span>Tôi đồng ý với <a href="#" class="terms-link">Điều khoản dịch vụ</a> của VCareer.</span>
            </label>
          </div>

          <!-- Create Order Button -->
          <button 
            type="button" 
            class="create-order-btn"
            (click)="onCreateOrder()">
            Thanh toán
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty Cart State -->
  <div class="empty-cart" *ngIf="cartItems.length === 0">
    <div class="empty-cart-content">
      <i class="fa fa-shopping-cart empty-icon"></i>
      <h2 class="empty-title">Giỏ hàng của bạn đang trống</h2>
      <p class="empty-description">Hãy thêm sản phẩm vào giỏ hàng để tiếp tục mua sắm</p>
      <button 
        type="button" 
        class="continue-shopping-btn"
        (click)="onContinueShopping()">
        Tiếp tục mua sắm
      </button>
    </div>
  </div>

  <!-- VNPAY Payment Modal -->
  <app-vnpay-payment-modal
    [show]="showVnpayModal"
    [paymentInfo]="paymentInfo"
    (close)="onCloseVnpayModal()"
    (decline)="onDeclineVnpayModal()">
  </app-vnpay-payment-modal>
</div>

