<header class="candidate-header">
  <div class="header-container">
    <!-- Logo -->
    <div class="logo-section" (click)="navigateToHome()">
      <img src="assets/images/logo/logo.png" alt="VCareer" class="logo-image">
    </div>

    <!-- Desktop Navigation Menu -->
    <nav class="nav-menu desktop-nav">
      <ul class="nav-list">
        <li class="nav-item">
          <a (click)="navigateToHome(); $event.preventDefault()" 
             class="nav-link" 
             [class.active]="isActiveRoute('/') || isActiveRoute('/home')">
            {{ translate('header.home') }}
          </a>
        </li>
        <li class="nav-item">
          <a (click)="navigateToJobs(); $event.preventDefault()" 
             class="nav-link" 
             [class.active]="isActiveRoute('/candidate/job')">
            {{ translate('header.jobs') }}
          </a>
        </li>
        <li class="nav-item">
          <a (click)="navigateToCompanies(); $event.preventDefault()" 
             class="nav-link" 
             [class.active]="isActiveRoute('/candidate/company') || isActiveRoute('/candidate/companies')">
            {{ translate('header.companies') }}
          </a>
        </li>
        <li class="nav-item">
          <a (click)="navigateToAbout(); $event.preventDefault()" 
             class="nav-link" 
             [class.active]="isActiveRoute('/candidate/about-us')">
            {{ translate('header.about') }}
          </a>
        </li>
        <li class="nav-item">
          <a (click)="navigateToContact(); $event.preventDefault()" 
             class="nav-link" 
             [class.active]="isActiveRoute('/candidate/contact')">
            {{ translate('header.contact') }}
          </a>
        </li>
      </ul>
    </nav>

    <!-- Right Section -->
    <div class="right-section">
      <!-- Language Toggle -->
      <app-language-toggle 
        [selectedLanguage]="selectedLanguage"
        (languageChange)="onLanguageChange($event)">
      </app-language-toggle>

      <!-- Not Logged In State -->
      <div class="auth-actions" *ngIf="!isLoggedIn">
      <button class="login-btn" (click)="navigateToLogin()">
          {{ translate('header.login') }}
      </button>
      <button class="register-btn" (click)="navigateToRegister()">
          {{ translate('header.register') }}
      </button>
      <button class="recruiter-btn" (click)="navigateToRecruiter()">
          {{ translate('header.post_job') }}
        </button>
      </div>

      <!-- Logged In State -->
      <div class="user-actions" *ngIf="isLoggedIn">
        <!-- Notifications -->
        <div class="notification-container" #notificationContainer>
          <button class="notification-btn" (click)="toggleNotificationMenu()" title="Thông báo">
            <i class="fa fa-bell"></i>
            <span class="notification-badge">1</span>
          </button>

          <!-- Notification Menu Dropdown -->
          <div class="notification-menu" *ngIf="showNotificationMenu">
            <!-- Header -->
            <div class="notification-header">
              <h3 class="notification-title">{{ translate('notifications.title') }}</h3>
              <button class="mark-read-btn" (click)="markAllAsRead()">
                {{ translate('notifications.mark_all_read') }}
              </button>
            </div>

            <!-- Notification Items -->
            <div class="notification-items">
              <!-- Sample notification item -->
              <div class="notification-item">
                <div class="notification-content">
                  <h4 class="notification-text">{{ translate('notifications.sample_text') }}</h4>
                  <span class="notification-date">15/10/2025</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Profile Container -->
        <div class="profile-container" (mouseenter)="showProfileMenu = true" (mouseleave)="onProfileMouseLeave()">
          <!-- User Profile -->
          <div class="user-profile">
            <div class="user-avatar-placeholder">
              <i class="fa fa-user"></i>
            </div>
          </div>

          <!-- Profile Menu Dropdown -->
          <div class="profile-menu" *ngIf="showProfileMenu" (mouseenter)="showProfileMenu = true" (mouseleave)="onProfileMouseLeave()">
          <!-- User Info -->
          <div class="profile-header">
            <div class="profile-avatar">
              <i class="fa fa-user"></i>
            </div>
            <div class="profile-info">
              <h3 class="profile-name">{{ currentUser?.name || currentUser?.userName || 'Người dùng' }}</h3>
              <p class="profile-status">{{ translate('profile.verified_account') }}</p>
              <p class="profile-details" *ngIf="currentUser">
                <span *ngIf="currentUser.id">ID {{ currentUser.id }}</span>
                <span *ngIf="currentUser.id && currentUser.email"> | </span>
                <span *ngIf="currentUser.email">{{ currentUser.email }}</span>
              </p>
            </div>
          </div>

          <!-- Menu Sections -->
          <div class="menu-sections">
            <!-- Quản lý tìm việc -->
            <div class="menu-section" (click)="toggleSection('jobManagement')">
              <div class="section-header">
                <div class="section-icon">
                  <i class="fa fa-briefcase"></i>
                  <span class="notification-dot"></span>
                </div>
                <span class="section-title">{{ translate('profile.job_management') }}</span>
                <i class="fa fa-chevron-down section-chevron" [class.rotated]="expandedSections.jobManagement"></i>
              </div>
              <div class="section-content" *ngIf="expandedSections.jobManagement">
                <div class="menu-item" (click)="navigateToSavedJobs()">{{ translate('profile.saved_jobs') }}</div>
                <div class="menu-item" (click)="navigateToAppliedJobs()">{{ translate('profile.applied_jobs') }}</div>
              </div>
            </div>

            <!-- Quản lý CV & Cover letter -->
            <div class="menu-section" (click)="toggleSection('cvManagement')">
              <div class="section-header">
                <div class="section-icon">
                  <i class="fa fa-file-text"></i>
                  <span class="notification-dot"></span>
                </div>
                <span class="section-title">{{ translate('profile.cv_management') }}</span>
                <i class="fa fa-chevron-down section-chevron" [class.rotated]="expandedSections.cvManagement"></i>
              </div>
                          <div class="section-content" *ngIf="expandedSections.cvManagement">
                            <div class="menu-item" (click)="navigateToCvManagement()">{{ translate('profile.my_cv') }}</div>
                          </div>
            </div>

                        <!-- Cài đặt email & thông báo -->
                        <div class="menu-section" (click)="toggleSection('emailSettings')">
                          <div class="section-header">
                            <div class="section-icon">
                              <i class="fa fa-envelope"></i>
                              <span class="notification-dot"></span>
                            </div>
                            <span class="section-title">{{ translate('profile.email_settings') }}</span>
                            <i class="fa fa-chevron-down section-chevron" [class.rotated]="expandedSections.emailSettings"></i>
                          </div>
                          <div class="section-content" *ngIf="expandedSections.emailSettings">
                            <div class="menu-item">{{ translate('profile.job_notification_settings') }}</div>
                            <div class="menu-item">{{ translate('profile.email_reception_settings') }}</div>
                          </div>
                        </div>

                        <!-- Cá nhân & Bảo mật -->
                        <div class="menu-section" (click)="toggleSection('personalSecurity')">
                          <div class="section-header">
                            <div class="section-icon">
                              <i class="fa fa-shield"></i>
                              <span class="notification-dot"></span>
                            </div>
                            <span class="section-title">{{ translate('profile.personal_security') }}</span>
                            <i class="fa fa-chevron-down section-chevron" [class.rotated]="expandedSections.personalSecurity"></i>
                          </div>
                          <div class="section-content" *ngIf="expandedSections.personalSecurity">
                            <div class="menu-item" (click)="navigateToPersonalInfo()">{{ translate('profile.personal_info_settings') }}</div>
                            <div class="menu-item">{{ translate('profile.security_settings') }}</div>
                            <div class="menu-item" (click)="navigateToChangePassword()">{{ translate('profile.change_password') }}</div>
                          </div>
                        </div>

                        <!-- Nâng cấp tài khoản -->
                        <div class="menu-section" (click)="toggleSection('upgradeAccount')">
                          <div class="section-header">
                            <div class="section-icon">
                              <i class="fa fa-star"></i>
                              <span class="notification-dot"></span>
                            </div>
                            <span class="section-title">{{ translate('profile.upgrade_account') }}</span>
                            <i class="fa fa-chevron-down section-chevron" [class.rotated]="expandedSections.upgradeAccount"></i>
                          </div>
                          <div class="section-content" *ngIf="expandedSections.upgradeAccount">
                            <div class="menu-item" (click)="navigateToService()">{{ translate('profile.upgrade_vip_account') }}</div>
                          </div>
                        </div>
          </div>

          <!-- Logout Button -->
          <div class="logout-section">
            <button class="logout-btn" (click)="logout()">
              <i class="fa fa-sign-out"></i>
              {{ translate('profile.logout') }}
            </button>
          </div>
        </div>
        </div>

        <!-- Separator -->
        <div class="separator"></div>

        <!-- Recruiter CTA -->
        <div class="recruiter-cta">
          <p class="cta-text">{{ translate('header.are_you_recruiter') }}</p>
          <button class="cta-link" (click)="navigateToRecruiter()">
            {{ translate('header.post_job_now') }} >>
      </button>
        </div>
      </div>
      
      <!-- Mobile Menu Toggle -->
      <button class="mobile-menu-toggle" (click)="toggleMobileMenu()">
        <i class="fa fa-bars"></i>
      </button>
    </div>
  </div>

  <!-- Mobile Navigation Menu -->
  <nav class="nav-menu mobile-nav" [class.open]="isMenuOpen">
    <ul class="nav-list">
      <li class="nav-item">
        <a (click)="navigateToHome(); $event.preventDefault()" 
           class="nav-link" 
           [class.active]="isActiveRoute('/') || isActiveRoute('/home')">
          {{ translate('header.home') }}
        </a>
      </li>
      <li class="nav-item">
        <a (click)="navigateToJobs(); $event.preventDefault()" 
           class="nav-link" 
           [class.active]="isActiveRoute('/candidate/job')">
          {{ translate('header.jobs') }}
        </a>
      </li>
      <li class="nav-item">
        <a (click)="navigateToCompanies(); $event.preventDefault()" 
           class="nav-link" 
           [class.active]="isActiveRoute('/candidate/companies')">
          {{ translate('header.companies') }}
        </a>
      </li>
      <li class="nav-item">
        <a (click)="navigateToAbout(); $event.preventDefault()" 
           class="nav-link" 
           [class.active]="isActiveRoute('/candidate/about-us')">
          {{ translate('header.about') }}
        </a>
      </li>
      <li class="nav-item">
        <a (click)="navigateToContact(); $event.preventDefault()" 
           class="nav-link" 
           [class.active]="isActiveRoute('/candidate/contact')">
          {{ translate('header.contact') }}
        </a>
      </li>
      <li class="nav-item mobile-auth">
        <app-language-toggle 
          [selectedLanguage]="selectedLanguage"
          (languageChange)="onLanguageChange($event)">
        </app-language-toggle>
        <button class="login-btn" (click)="navigateToLogin()">
          {{ translate('header.login') }}
        </button>
        <button class="register-btn" (click)="navigateToRegister()">
          {{ translate('header.register') }}
        </button>
        <button class="recruiter-btn" (click)="navigateToRecruiter()">
          {{ translate('header.post_job') }}
        </button>
      </li>
    </ul>
  </nav>
</header>